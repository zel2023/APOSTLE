fix bug in double precision functions