Fix a bug in the greatest common divisor