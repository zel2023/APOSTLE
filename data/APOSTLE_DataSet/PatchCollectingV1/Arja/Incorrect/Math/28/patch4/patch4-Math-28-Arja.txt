Improved the linear search code