added a bit more tidying of the areEqual method